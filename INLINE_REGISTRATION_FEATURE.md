# Inline-—Å—Ç–∏–ª—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

## –û–±–∑–æ—Ä
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –Ω–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤ —Å—Ç–∏–ª–µ inline –º–µ–Ω—é - –∫–∞–∂–¥—ã–π —à–∞–≥ –∑–∞–º–µ–Ω—è–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –≤–º–µ—Å—Ç–æ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö. –¢–µ–ø–µ—Ä—å –≤–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –æ–¥–Ω–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏.

## –ù–æ–≤–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

### –î–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
```
Bot: üïäÔ∏è Welcome to Yoga Principles Bot! Choose language: [EN] [RU]
Bot: ‚úÖ Language set to Russian!
Bot: üìç Step 1/3: Time Zone. Please specify...
Bot: ‚úÖ Time zone saved!
Bot: ‚è∞ Step 2/3: Send Time. Please specify time...
Bot: ‚úÖ Send time saved!
Bot: üìÖ Step 3/3: Days to Skip. Specify weekdays...
Bot: üéâ Setup Complete! Your Settings: ...
```

### –ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
```
Bot: üïäÔ∏è Welcome to Yoga Principles Bot! Choose language: [EN] [RU]
     ‚Üì (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —è–∑—ã–∫)
     ‚úÖ Language set to Russian!
     üìç Step 1/3: Time Zone. Please specify...
     ‚Üì (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç timezone)
     ‚úÖ Time zone saved!
     ‚è∞ Step 2/3: Send Time. Please specify time...
     ‚Üì (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –≤—Ä–µ–º—è)
     ‚úÖ Send time saved!
     üìÖ Step 3/3: Days to Skip. Specify weekdays...
     ‚Üì (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –¥–Ω–∏)
     üéâ Setup Complete! Your Settings: ... [–ú–µ–Ω—é]
```

**–û–î–ù–û —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –≤—Å–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞!**

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

1. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ message_id:**
   ```python
   # –ü—Ä–∏ –≤—ã–±–æ—Ä–µ —è–∑—ã–∫–∞ –¥–ª—è –Ω–æ–≤–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
   self.user_states[chat_id] = {
       "step": "timezone",
       "language": language,
       "registration_message_id": query.message.message_id  # –°–æ—Ö—Ä–∞–Ω—è–µ–º ID —Å–æ–æ–±—â–µ–Ω–∏—è
   }
   ```

2. **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–º–µ—Å—Ç–æ —Å–æ–∑–¥–∞–Ω–∏—è:**
   ```python
   # –í–º–µ—Å—Ç–æ update.message.reply_text()
   if message_id:
       await self.application.bot.edit_message_text(
           chat_id=chat_id,
           message_id=message_id,
           text=combined_msg,
           parse_mode='Markdown'
       )
   ```

### –ü–æ—à–∞–≥–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å

1. **–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ (`/start`):**
   - –°–æ–∑–¥–∞–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –≤—ã–±–æ—Ä–æ–º —è–∑—ã–∫–∞
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è `message_id` –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è

2. **–í—ã–±–æ—Ä —è–∑—ã–∫–∞:**
   - –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ —à–∞–≥ "timezone"
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è `registration_message_id` –≤ `user_states`

3. **–í–≤–æ–¥ timezone:**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è (–∫–∞–∫ –æ–±—ã—á–Ω–æ)
   - –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø–æ–∫–∞–∑–∞ —à–∞–≥–∞ "time"

4. **–í–≤–æ–¥ –≤—Ä–µ–º–µ–Ω–∏:**
   - –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø–æ–∫–∞–∑–∞ —à–∞–≥–∞ "skip_days"

5. **–í–≤–æ–¥ –¥–Ω–µ–π –ø—Ä–æ–ø—É—Å–∫–∞:**
   - –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø–æ–∫–∞–∑–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Å –º–µ–Ω—é

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–í—Å–µ –æ—à–∏–±–∫–∏ —Ç–µ–ø–µ—Ä—å —Ç–∞–∫–∂–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É—é—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:

```python
if not is_valid_timezone(timezone_str):
    if message_id:
        await self.application.bot.edit_message_text(
            chat_id=chat_id,
            message_id=message_id,
            text=self._get_text("invalid_timezone", language),
            parse_mode='Markdown'
        )
    return
```

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –Ω–∞—Å—Ç—Ä–æ–µ–∫

–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫:

1. **–ö–ª–∏–∫ –Ω–∞ "Change Time":**
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è `settings_message_id`
   - –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –ø–æ –≤–≤–æ–¥—É –≤—Ä–µ–º–µ–Ω–∏

2. **–í–≤–æ–¥ –Ω–æ–≤–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏:**
   - –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è —Ç–æ –∂–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –∏ –º–µ–Ω—é

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–ß–∏—Å—Ç—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:** –¢–æ–ª—å–∫–æ –æ–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤–º–µ—Å—Ç–æ 6-8
2. **–õ—É—á—à–∏–π UX:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Ç–µ—Ä—è–µ—Ç—Å—è –≤ –ø–æ—Ç–æ–∫–µ —Å–æ–æ–±—â–µ–Ω–∏–π
3. **–ú–æ–±–∏–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –ú–µ–Ω—å—à–µ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ
4. **–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –≤–∏–¥:** –ö–∞–∫ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
5. **–≠–∫–æ–Ω–æ–º–∏—è –º–µ—Å—Ç–∞:** –ú–µ–Ω—å—à–µ —Å–ø–∞–º–∞ –≤ —á–∞—Ç–µ

## Fallback –ª–æ–≥–∏–∫–∞

–ö–æ–¥ —Å–æ–¥–µ—Ä–∂–∏—Ç fallback –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ `message_id` –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω:

```python
if message_id:
    # –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    await self.application.bot.edit_message_text(...)
else:
    # Fallback: —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    await update.message.reply_text(...)
```

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- –°–æ–æ–±—â–µ–Ω–∏—è —Å—Ç–∞—Ä—à–µ 48 —á–∞—Å–æ–≤ –Ω–µ –º–æ–≥—É—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ Telegram API)
- –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –±—ã–ª–æ —É–¥–∞–ª–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback
- –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

## –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ SPA-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ, –±—ã—Å—Ç—Ä–æ –∏ –±–µ–∑ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –º—É—Å–æ—Ä–∞! üéâ 